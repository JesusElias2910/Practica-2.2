# Practica-2.2

# 2.1 Practica Hola Mundo y la Hora de Internet (NTP Time server) 
Depto de Sistemas y Computación  
Ing. En Sistemas Computacionales  
SISTEMAS PROGRAMABLES 23a  
Autor: Jesús Elías Martínez  
Fecha de entrega:   16/10/2023  
Objetivo: Investigar y prácticar la maniuplación de la raspberry pico W con la pantalla oled con su propio sensor de temperatura  

**Modelado en wokwi**  
![](Imagenes/modelado.png)  

**Conexiones (en físico)**  
![](Imagenes/conec.jpg) 

**Código de thonny**   
Lenguaje: Phyton
```
#Jesús Elías Martínez    No. control: 20211768
#Importación de librerías
from machine import ADC
import utime
from machine import Pin, I2C
from ssd1306 import SSD1306_I2C
import framebuf, sys

#Verificación de que la OLED existe y esta bien conectada
def init_i2c(scl_pin, sda_pin):
    i2c_dev = I2C(0, scl=Pin(scl_pin), sda=Pin(sda_pin), freq=200000)
    i2c_addr = [hex(ii) for ii in i2c_dev.scan()]
   
    if not i2c_addr:
        print('Pantalla I2C no encontrada')
        sys.exit()
    else:
        print("I2C Address : {}".format(i2c_addr[0]))
        print("I2C Configuration: {}".format(i2c_dev))
       
    return i2c_dev

#configuración de I2C con la pantalla OLED
i2c = init_i2c(scl_pin=9,sda_pin=8) #configuración física
Pan_Oled = SSD1306_I2C(128,64,i2c) #configuración de la pantalla

sensor = ADC(4)

#Bitarray de la imágen calido
calido = [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x7e, 0x00, 0x00, 0x00, 0x07, 0xff, 0xe0, 0x00, 0x00, 0x3f, 0xff, 0xfc, 0x00, 0x00, 0x7f, 
0xff, 0xfe, 0x00, 0x00, 0xff, 0xff, 0xff, 0x00, 0x01, 0xff, 0xff, 0xff, 0x80, 0x03, 0xff, 0xff, 
0xff, 0xc0, 0x07, 0xff, 0xff, 0xff, 0xe0, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x20, 0x00, 0x04, 0x00, 0x18, 0x40, 0x00, 
0x04, 0x00, 0x3c, 0x40, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 
0x00, 0x3c, 0x00, 0x00, 0x20, 0x00, 0x7e, 0x00, 0x04, 0x30, 0x00, 0xff, 0x00, 0x0c, 0x18, 0x01, 
0xff, 0x80, 0x18, 0x1e, 0x0f, 0xff, 0xf0, 0x78, 0x1f, 0xf9, 0xff, 0xdf, 0xf8, 0x1f, 0xf8, 0x00, 
0x1f, 0xf8, 0x0f, 0xf8, 0x00, 0x1f, 0xf0, 0x0f, 0xfc, 0x00, 0x3f, 0xf0, 0x07, 0xff, 0x00, 0xff, 
0xe0, 0x07, 0xff, 0xc3, 0xff, 0xe0, 0x03, 0xff, 0xff, 0xff, 0xc0, 0x01, 0xff, 0xff, 0xff, 0x80, 
0x00, 0xff, 0xff, 0xff, 0x00, 0x00, 0x7f, 0xff, 0xfe, 0x00, 0x00, 0x1f, 0xff, 0xf8, 0x00, 0x00, 
0x07, 0xff, 0xe0, 0x00, 0x00, 0x00, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

#Bitarray de la imágen frío
frio = [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x07, 0xf8, 0x00, 0x00, 0x00, 0x3c, 0x0f, 0xe0, 0x00, 0x00, 0x60, 0x00, 0x10, 0x00, 0x00, 0xc0, 
0x00, 0x10, 0x00, 0x00, 0x80, 0x00, 0x38, 0x00, 0x01, 0x80, 0x0f, 0xed, 0xb0, 0x01, 0x80, 0xf8, 
0x06, 0xd8, 0x01, 0x83, 0xe0, 0x06, 0xc8, 0x01, 0xfe, 0x00, 0x07, 0x5c, 0x03, 0x00, 0x00, 0x0b, 
0x14, 0x02, 0x00, 0x00, 0x08, 0x04, 0x06, 0x00, 0x00, 0x07, 0x1c, 0x0e, 0x00, 0x00, 0x06, 0xc8, 
0x39, 0xc7, 0x00, 0xe2, 0xd8, 0x2b, 0x47, 0x00, 0xe3, 0xf0, 0x42, 0x47, 0x00, 0xe0, 0x30, 0x31, 
0xc7, 0x00, 0xe0, 0x30, 0x70, 0xc0, 0x00, 0x00, 0x30, 0x6b, 0x60, 0x00, 0x00, 0x30, 0x39, 0xc7, 
0xff, 0xe0, 0x30, 0x0f, 0x1f, 0xff, 0xf8, 0x30, 0x06, 0x24, 0x99, 0x24, 0x20, 0x04, 0x2c, 0x99, 
0x24, 0x20, 0x02, 0x7f, 0xff, 0xfc, 0x40, 0x02, 0x24, 0x99, 0x24, 0x40, 0x03, 0x3c, 0x99, 0x3c, 
0xc0, 0x01, 0x8f, 0xff, 0xf1, 0x80, 0x01, 0xc0, 0x00, 0x03, 0x00, 0x03, 0xf0, 0x00, 0x06, 0x00, 
0x02, 0x10, 0x00, 0x0c, 0x00, 0x03, 0x3c, 0x00, 0x38, 0x00, 0x02, 0xd7, 0x81, 0xe0, 0x00, 0x03, 
0x71, 0xff, 0x80, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

#Bitarray de la imágen caliente
caliente = [
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x3c, 0x00, 0x00, 0x00, 0x03, 0xff, 0xc0, 0x00, 0x00, 0x0e, 0x00, 0x70, 0x00, 0x00, 0x30, 
0x00, 0x1c, 0x60, 0x00, 0x60, 0x00, 0x06, 0xe0, 0x00, 0xc0, 0x00, 0x03, 0xb0, 0x01, 0x80, 0x00, 
0x01, 0x18, 0x03, 0x00, 0x00, 0x03, 0x08, 0x02, 0x06, 0x00, 0x62, 0x0c, 0x06, 0x1c, 0x00, 0x3e, 
0x04, 0x04, 0x70, 0x00, 0x0e, 0x04, 0x0c, 0x00, 0x00, 0x04, 0x04, 0x0c, 0x02, 0x00, 0x46, 0x04, 
0x08, 0x07, 0x00, 0xe2, 0x0c, 0x08, 0x0f, 0x00, 0xe1, 0xf8, 0x08, 0x07, 0x00, 0xe0, 0xf0, 0x0e, 
0x07, 0x00, 0xe0, 0x10, 0x0f, 0x00, 0x00, 0x00, 0x10, 0x0d, 0x80, 0x00, 0x00, 0x10, 0x18, 0x80, 
0x00, 0x00, 0x10, 0x10, 0xc0, 0x00, 0x00, 0x30, 0x30, 0x40, 0x7c, 0x00, 0x30, 0x20, 0x63, 0xff, 
0xc0, 0x20, 0x20, 0x26, 0x10, 0x60, 0x60, 0x20, 0x2e, 0x10, 0x70, 0x40, 0x20, 0x6e, 0x10, 0x70, 
0xc0, 0x30, 0x46, 0x10, 0x61, 0x80, 0x1f, 0xc2, 0x10, 0x41, 0x00, 0x06, 0x62, 0x00, 0x46, 0x00, 
0x00, 0x32, 0x00, 0x4c, 0x00, 0x00, 0x1f, 0x00, 0xf8, 0x00, 0x00, 0x07, 0x81, 0xc0, 0x00, 0x00, 
0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

#Ciclo para el despliegue
while True:
    valor = sensor.read_u16()*3.3/65535 #Lectura de la temperatura del sensor y conversión
    tempertaturaSen = 27-(valor-0.706)/0.001721 #Obtener la temperatura con fórmula y el valor del sensor
    utime.sleep(1) #Pausa el programa 1 segundo
   
    #Condición para desplegar las 3 imagenes diferentes dependiendo la temperatura
    if tempertaturaSen >= 18 and tempertaturaSen <= 30.0:
        print("Calido")
        imagen = framebuf.FrameBuffer(bytearray(calido),40,40,framebuf.MONO_HLSB) #Se crea el obejto y se define donde se colocará en OLED
        Pan_Oled.fill(0) #Todos los pixeles de OLED en negro
        Pan_Oled.text("Temp: " + str(tempertaturaSen), 0, 0) #Despliegue de temperatura en OLED
        Pan_Oled.blit(imagen,40,15) #Posición de imagen en OLED
        Pan_Oled.show() #Mostrar la imagen
    else:
        if tempertaturaSen <= 17:
            print("Frío")
            imagen = framebuf.FrameBuffer(bytearray(frio),40,40,framebuf.MONO_HLSB) #Se crea el obejto y se define donde se colocará en OLED
            Pan_Oled.fill(0) #Todos los pixeles de OLED en negro
            Pan_Oled.text("Temp: " + str(tempertaturaSen), 0, 0) #Despliegue de temperatura en OLED
            Pan_Oled.blit(imagen,30,15) #Posición de imagen en OLED
            Pan_Oled.show() #Mostrar la imagen
        else:
            print("Caliente")
            imagen = framebuf.FrameBuffer(bytearray(caliente),40,40,framebuf.MONO_HLSB) #Se crea el obejto y se define donde se colocará en OLED
            Pan_Oled.fill(0) #Todos los pixeles de OLED en negro
            Pan_Oled.text("Temp: " + str(tempertaturaSen), 0, 0) #Despliegue de temperatura en OLED
            Pan_Oled.blit(imagen,40,15) #Posición de imagen en OLED
            Pan_Oled.show() #Mostrar la imagen
```

**Resultados**  
Calor
![](Imagenes/calor.jpg)  

Cálido
![](Imagenes/temp.jpg)  

Frío
![](Imagenes/frio.jpg)  

